
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Group Project: Get Up &amp; Running &#8212; COMP3631 Website</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=605502e1" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script src="_static/documentation_options.js?v=296c0a1b"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'project-up-and-running';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/comp3631-logo-large-title.png" class="logo__image only-light" alt="COMP3631 Website - Home"/>
    <script>document.write(`<img src="_static/comp3631-logo-large-title.png" class="logo__image only-dark" alt="COMP3631 Website - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    COMP3631 Lab Worksheets
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="teaching-assistants.html">1. Teaching/Lab Assistants</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">2. Frequently Asked Questions (FAQ) and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab1.html">3. Lab 1.1: Setting up your environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab1-optional.html">4. Lab 1.2: Learn about the command line interface and Git/GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab2.html">5. Lab 2: Writing a Talker and Listener</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab3.html">6. Lab 3: Actuating the turtlebot in simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab4.html">7. Lab 4: Mapping and Navigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab5.html">8. Lab 5: Computer Vision: Processing robot’s camera view</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_the_real_robot.html">9. How to use the real-robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab6.html">10. Lab 6: Real-robot lab</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Group Project: Get Up & Running</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#important-update-your-package">(IMPORTANT) Update your package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clone-your-group-repo">Clone your group repo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-the-project-in-simulation">How to run the project in simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-points">Input points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-new-worlds">Creating new worlds</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planet-images-and-alignment">Planet Images and Alignment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-images">Saving images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use-python-and-supporting-files-in-your-project">How to use Python and supporting files in your project</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recording-video-in-simulation">Recording video in simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#real-robot">Real Robot</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="group-project-get-up-running">
<span id="get-up-running-sec"></span><h1>Group Project: Get Up &amp; Running<a class="headerlink" href="#group-project-get-up-running" title="Link to this heading">#</a></h1>
<section id="important-update-your-package">
<h2>(IMPORTANT) Update your package<a class="headerlink" href="#important-update-your-package" title="Link to this heading">#</a></h2>
<p>We have made a number of changes to this package for the group project. It’s
important that you update it before starting working on the project.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">ros2_ws</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">turtlebot3_simulations</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">cd</span> <span class="o">~/</span><span class="n">ros2_ws</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">build</span> <span class="n">install</span> <span class="n">log</span>
<span class="n">colcon</span> <span class="n">build</span>
</pre></div>
</div>
</section>
<section id="clone-your-group-repo">
<h2>Clone your group repo<a class="headerlink" href="#clone-your-group-repo" title="Link to this heading">#</a></h2>
<p>You should, by now, have joined a group repository on GitHub. Clone it under
your workspace.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">ros2_ws</span><span class="o">/</span><span class="n">src</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">COMP3631</span><span class="o">/</span><span class="n">groupX</span> <span class="n">group_project</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">groupX</span></code> is the name of your group.
Don’t forget to build the workspace:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">..</span>
<span class="n">colcon</span> <span class="n">build</span>
</pre></div>
</div>
</section>
<section id="how-to-run-the-project-in-simulation">
<h2>How to run the project in simulation<a class="headerlink" href="#how-to-run-the-project-in-simulation" title="Link to this heading">#</a></h2>
<p>It would be wise to start working on this project in simulation first, before
you attempt running your solution on a real robot.</p>
<p>To help you navigate the project, we provide three worlds of increasing
difficulty. These are just examples. We provide instructions of how to
generate new worlds.</p>
<p>To launch different worlds, you need to follow the following steps:</p>
<div class="docutils">
<h4 class="rubric" id="step-1-launch-gazebo-using-different-worlds">Step 1: Launch Gazebo using different worlds</h4>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">world</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">easy</span>
<span class="c1"># or</span>
<span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">world</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">moderate</span>
<span class="c1"># or</span>
<span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">world</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">hard</span>
</pre></div>
</div>
<div class="docutils">
<h4 class="rubric" id="step-2-launch-localisation">Step 2: Launch Localisation</h4>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">navigation</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">easy</span>
<span class="c1"># or</span>
<span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">navigation</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">moderate</span>
<span class="c1"># or</span>
<span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">navigation</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">hard</span>
</pre></div>
</div>
<div class="docutils">
<h4 class="rubric" id="step-3-localise-the-robot-in-rviz">Step 3: Localise the robot in Rviz</h4>
</div>
<p>As you learned in <a class="reference internal" href="lab4.html"><span class="std std-doc">lab 4</span></a>, you need to provide an initial estimate of
the robot in Rviz to help it localise itself initially. Please do that through
Rviz.</p>
<div class="docutils">
<h4 class="rubric" id="step-4-send-some-goal-poses-to-the-robot-to-help-it-localise-better">Step 4: Send some goal poses to the robot to help it localise better</h4>
</div>
<p>After you provide the initial estimate, using Rviz send 1-2 goals to help the
robot localise better.</p>
<div class="docutils">
<h4 class="rubric" id="step-5-move-the-robot-to-an-initial-position">Step 5: Move the robot to an initial position</h4>
</div>
<p>Your robot may be loaded in one of the modules. For the group project, we will
start your robot in the <strong>corridor</strong>. Please send a goal pose through Rviz to
move the robot to one of the corners of the corridor (such that it cannot see
any of the entrance red/green circles).</p>
<div class="docutils">
<h4 class="rubric" id="step-6-launch-your-solution-to-solve-the-problem">Step 6: Launch your solution to solve the problem</h4>
</div>
<p>Once you start Gazebo, navigation, you localise the robot, and you move the
robot to a corner of the corridor, it’s time to run your solution to solve
the problem.
It’s important to launch your solution using our launch file to make your
script aware of the different coordinate points of the modules. Here is how:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">robotnaut_go</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">easy</span>
<span class="c1"># or</span>
<span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">robotnaut_go</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">moderate</span>
<span class="c1"># or</span>
<span class="n">ros2</span> <span class="n">launch</span> <span class="n">group_project</span> <span class="n">robotnaut_go</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span> <span class="n">world</span><span class="o">:=</span><span class="n">hard</span>
</pre></div>
</div>
<p>We ask that you implement your code such that the complete solution is runnable
with the above ros launch commands.</p>
<p>This is already a target in <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>, you simply need to write code
in the <code class="docutils literal notranslate"><span class="pre">group_project/group_project/robonaut.py</span></code> file. Please feel
free to break your code down to different files, if you want to. We
simply ask that there is only one entrance point to your solution,
and that is the <code class="docutils literal notranslate"><span class="pre">robonaut_go</span></code>. The <code class="docutils literal notranslate"><span class="pre">world:=easy</span></code> part make sure to load
the right input coordinates so that your robot can travel to the right points
in space.</p>
<section id="input-points">
<h3>Input points<a class="headerlink" href="#input-points" title="Link to this heading">#</a></h3>
<p>As we describe in the project description, we will provide you with the (x,y)
coordinates of four points: the centre and entrance points of the two modules.</p>
<p>These values are loaded and provided into your main program by the ros launch
file (<code class="docutils literal notranslate"><span class="pre">robonaut_go.launch.py</span></code>). The <code class="docutils literal notranslate"><span class="pre">Robonaut</span></code>
(<code class="docutils literal notranslate"><span class="pre">group_project/group_project/robonaut.py</span></code>) class includes some comments of how
to load and make use of the coordinate points.</p>
</section>
<section id="creating-new-worlds">
<h3>Creating new worlds<a class="headerlink" href="#creating-new-worlds" title="Link to this heading">#</a></h3>
<p>Once you build a first solution that works in the three provided worlds,
we encourage you to create your own worlds to stress test your solution further.
Here are some notes on how to do this.</p>
<p>If you create new worlds, make sure to commit and push the changes to GitHub,
we will consider such custom worlds as a good sign under the requirement of
creating and testing your solution for robustness.</p>
<div class="docutils">
<h4 class="rubric" id="first-create-the-world">First create the world</h4>
</div>
<p>To create a new world, you can follow the steps outlined below within a singularity
environment.</p>
<details>
  <summary>Click here to learn more</summary>
<ol class="arabic simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">GAZEBO_MODEL_PATH=$HOME/ros2_ws/src/turtlebot3_simulations/turtlebot3_gazebo/models/</span></code>.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">gazebo</span></code> to launch an empty Gazebo instance.</p></li>
<li><p>Navigate to “Insert” tab on the left vertical menu. You will see a list of
models to choose from. Start by adding walls to replicate two modules and then start adding obstacles.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do <strong>not</strong> add a robot in the world at this point, the robot is spawned
automatically by ROS using the ros launch file.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Once you are happy with your new world, click “File -&gt; Save World As” and
name it “gazebo.world”. Read the next section to find out where to put this to make it
discoverable.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Tips:</strong></p>
<ul class="simple">
<li><p>You may need to align the walls which can be tricky to do with the mouse.
Pick one wall and place it where you want to with the mouse. Then use that wall
as the reference for other walls. Click on the reference wall and make a note
of its pose (x, y, z, roll, pitch and yaw) from the left panel. Then fine tune
the other walls’ x, y, z, roll, pitch and yaw w.r.t to the reference wall.</p></li>
<li><p>When hanging windows or a poster on the wall, make sure to rotate your view
when they seem to be lost. Somehow they are not visible from the back.
They may also be invisible when they are in the wall. You can fine tune their
position from the pose properties on the left pane.</p></li>
</ul>
</div>
</details>
<div class="docutils">
<h4 class="rubric" id="make-the-new-world-discoverable-by-the-launch-file">Make the new world discoverable by the launch file</h4>
</div>
<p>To make your newly created world discoverable by the project’s launch file,
you need to create a new directory with a unique name under
<code class="docutils literal notranslate"><span class="pre">~/ros2_ws/src/group_project/worlds</span></code> and few modifications to the launch file
(click to expand the section below to learn more).</p>
<details>
  <summary>Click here to learn more</summary>
<br/>
<p>If you wanted to create a new test world called <code class="docutils literal notranslate"><span class="pre">easy2</span></code>, you could create a
new directory under <code class="docutils literal notranslate"><span class="pre">group_project/worlds</span></code> named <code class="docutils literal notranslate"><span class="pre">easy_2</span></code>.
Your new world directory should include
the following files, with the <strong>following names</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gazebo.world</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">map/map.pgm</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">map/map.yaml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coordinates.yaml</span></code> (please refer to <a class="reference internal" href="lab4.html"><span class="std std-doc">lab 4 worksheet</span></a> on how to obtain coordinates and have a look at the provided <code class="docutils literal notranslate"><span class="pre">coordinates.yaml</span></code> examples of how to structure this file).</p></li>
</ul>
<p>You then need to update <code class="docutils literal notranslate"><span class="pre">group_project/launch/worlds.yaml</span></code>
to append the new world:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">easy</span><span class="p">:</span> <span class="n">spacecraft_easy</span>
<span class="linenos">2</span><span class="n">moderate</span><span class="p">:</span> <span class="n">spacecraft_moderate</span>
<span class="linenos">3</span><span class="n">hard</span><span class="p">:</span> <span class="n">spacecraft_hard</span>
<span class="linenos">4</span><span class="n">real</span><span class="p">:</span> <span class="n">real_world</span>
<span class="linenos">5</span><span class="n">easy2</span><span class="p">:</span> <span class="n">easy_2</span>  <span class="c1"># &lt;--- your new world target here</span>
</pre></div>
</div>
<p>Please note that the key (<code class="docutils literal notranslate"><span class="pre">easy2</span></code>) is the target you need to use to launch it,
while the value (<code class="docutils literal notranslate"><span class="pre">easy_2</span></code>) is the actual directory name under
<code class="docutils literal notranslate"><span class="pre">group_project/worlds</span></code>.</p>
<p>If you had a directory called <code class="docutils literal notranslate"><span class="pre">~/ros2_ws/src/group_project/worlds/my_awesome_world</span></code>,
you could define the key as <code class="docutils literal notranslate"><span class="pre">easy2</span></code> (target) and as value <code class="docutils literal notranslate"><span class="pre">my_awesome_world</span></code> (directory name),
you could then run <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">launch</span> <span class="pre">group_project</span> <span class="pre">world.launch.py</span> <span class="pre">world:=easy2</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Every time you create new world or you update the launch file, you will need
to run <code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">build</span></code> <strong>within</strong> <code class="docutils literal notranslate"><span class="pre">~/ros2_ws</span></code>.</p>
</div>
</details>
</section>
</section>
<section id="planet-images-and-alignment">
<h2>Planet Images and Alignment<a class="headerlink" href="#planet-images-and-alignment" title="Link to this heading">#</a></h2>
<p>The green module of the spacecraft will contain at least two windows with
“views” of the Earth and the Moon. These have been constructed from the
database of “Moons and Planets” that can be found at:
<a class="github reference external" href="https://github.com/emirhanai/Planets-and-Moons-Dataset-AI-in-Space">emirhanai/Planets-and-Moons-Dataset-AI-in-Space</a></p>
<p>Other windows could also be found in the module with views of different planets
also constructed from this database. The module may also contain a poster with
images of  several different planets on it.</p>
<p>The “views” of the Earth and Moon have been created so that they overlap to
enable you to stitch them together. You may find that you cannot just use
random stars to align the images as they are too similar to each other. We have
therefore provided a further method <code class="docutils literal notranslate"><span class="pre">find_transform</span></code> in the module
<code class="docutils literal notranslate"><span class="pre">AJBastroalign.py</span></code> that you can use to do this. This works by matching patterns
of three stars rather than individual stars to provide the salient feature to
match on. There are lots of other methods available if you prefer to use
another.</p>
<details>
  <summary>Click here to see an example of the AJBastroalign module</summary>
<p>To use this module you need to first import it using the following line of
code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">group_project</span> <span class="kn">import</span> <span class="n">AJBastroalign</span>
</pre></div>
</div>
<p>You can then use a similar approach to the OpenCV one you used in the labs.
Below is an example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">#Assumes you have some keypoints (l_keypoints and r_keypoints) in the left and</span>
<span class="linenos"> 2</span><span class="c1"># right images respectively </span>
<span class="linenos"> 3</span>    
<span class="linenos"> 4</span><span class="c1"># convert keypoint to numpy array</span>
<span class="linenos"> 5</span><span class="c1"># In this case source is the right hand image</span>
<span class="linenos"> 6</span><span class="c1"># right_image is transformed to the target (left image)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="n">p</span><span class="o">.</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="o">.</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">r_keypoints</span><span class="p">])</span>
<span class="linenos"> 9</span><span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="n">p</span><span class="o">.</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="o">.</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">l_keypoints</span><span class="p">])</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">transform</span><span class="p">,(</span><span class="n">src_pts</span><span class="p">,</span><span class="n">dst_pts</span><span class="p">)</span> <span class="o">=</span> <span class="n">AJBastroalign</span><span class="o">.</span><span class="n">find_transform</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">max_control_points</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    
<span class="linenos">14</span><span class="c1"># If you want to display the points and the matches found</span>
<span class="linenos">15</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">src_pts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1240</span> <span class="o">-</span> <span class="n">src_pts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;xk&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">16</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dst_pts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1240</span> <span class="o">-</span> <span class="n">dst_pts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;og&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1"># Display correspondences </span>
<span class="linenos">19</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">src_pts</span><span class="p">)):</span>
<span class="linenos">20</span>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">src_pts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dst_pts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
<span class="linenos">21</span>                    <span class="p">[</span><span class="mi">1240</span><span class="o">-</span><span class="n">src_pts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1240</span><span class="o">-</span><span class="n">dst_pts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;-r&quot;</span><span class="p">)</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1"># To diplay the matrix you can use </span>
<span class="linenos">26</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transform&quot;</span><span class="p">,</span><span class="n">transform</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="c1"># and for its components</span>
<span class="linenos">29</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Translation &quot;</span><span class="p">,</span><span class="n">transform</span><span class="o">.</span><span class="n">translation</span><span class="p">)</span>
<span class="linenos">30</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;scale &quot;</span><span class="p">,</span><span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
<span class="linenos">31</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;rotation angle &quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">.</span><span class="n">rotation</span><span class="p">)</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="c1"># Convert transform to form OpenCV can use</span>
<span class="linenos">34</span><span class="n">homography</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="c1"># Apply transform to right image</span>
<span class="linenos">37</span><span class="n">result</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">warpPerspective</span><span class="p">(</span><span class="n">right_img</span><span class="p">,</span> <span class="n">homography</span><span class="p">,</span> <span class="p">(</span><span class="n">left_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">400</span><span class="p">,</span> <span class="n">left_img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">flags</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_LINEAR</span><span class="p">)</span>
</pre></div>
</div>
</details>
</section>
<section id="saving-images">
<h2>Saving images<a class="headerlink" href="#saving-images" title="Link to this heading">#</a></h2>
<p>To take pictures from the camera view of the robot (whether in simulation or not):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">run</span> <span class="n">image_view</span> <span class="n">image_view</span> <span class="n">image</span><span class="o">:=/</span><span class="n">camera</span><span class="o">/</span><span class="n">image_raw</span>
</pre></div>
</div>
<p>Right clicking in the window will save the current image. It can be useful
to obtain pictures from simulation and real-world to fine tune your CV
algorithm.</p>
</section>
<section id="how-to-use-python-and-supporting-files-in-your-project">
<h2>How to use Python and supporting files in your project<a class="headerlink" href="#how-to-use-python-and-supporting-files-in-your-project" title="Link to this heading">#</a></h2>
<div class="docutils">
<h4 class="rubric" id="python-files">Python files</h4>
</div>
<p>Python files that you need to import into your program should go under
<code class="docutils literal notranslate"><span class="pre">group_project/group_project</span></code> next to existing Python files. For example, if
you have a file called <code class="docutils literal notranslate"><span class="pre">my_file.py</span></code> that defines <code class="docutils literal notranslate"><span class="pre">MyClass</span></code>, it should live next
to <code class="docutils literal notranslate"><span class="pre">robonaut</span></code> under <code class="docutils literal notranslate"><span class="pre">group_project/group_project</span></code> (or in a sub-directory) and
you can import it in <code class="docutils literal notranslate"><span class="pre">robonaut.py</span></code> like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">group_project.my_file</span> <span class="kn">import</span> <span class="n">MyClass</span>
</pre></div>
</div>
<div class="docutils">
<h4 class="rubric" id="other-files">Other files</h4>
</div>
<p>However, if you need other files (other than Python files, like text files,
config files, image files etc) you can place those
files under <code class="docutils literal notranslate"><span class="pre">group_project/supporting_files</span></code>. Next time you
<code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">build</span></code> those files will become available to ROS.</p>
<p>Let’s say you have a file called <code class="docutils literal notranslate"><span class="pre">hello.txt</span></code> under <code class="docutils literal notranslate"><span class="pre">supporting_files</span></code>,
you can read it like so (and it will work on any computer):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">import</span> <span class="nn">os</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">ament_index_python.packages</span> <span class="kn">import</span> <span class="n">get_package_share_directory</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="n">package_path</span> <span class="o">=</span> <span class="n">get_package_share_directory</span><span class="p">(</span><span class="s1">&#39;group_project&#39;</span><span class="p">)</span>
<span class="linenos">5</span><span class="n">hello_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">package_path</span><span class="p">,</span> <span class="s1">&#39;supporting_files&#39;</span><span class="p">,</span> <span class="s1">&#39;hello.txt&#39;</span><span class="p">)</span>
<span class="linenos">6</span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">hello_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">hello_file</span><span class="p">:</span>
<span class="linenos">7</span>    <span class="c1"># do something with the hello_file</span>
</pre></div>
</div>
</section>
<section id="recording-video-in-simulation">
<h2>Recording video in simulation<a class="headerlink" href="#recording-video-in-simulation" title="Link to this heading">#</a></h2>
<p>We installed a screen recording tool in the container called <code class="docutils literal notranslate"><span class="pre">peek</span></code> for this.
You can run it from the CLI within the container like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peek</span>
</pre></div>
</div>
<p>Please make sure to change the default setting from <code class="docutils literal notranslate"><span class="pre">gif</span></code> to <code class="docutils literal notranslate"><span class="pre">mp4</span></code>:</p>
<p><img alt="" src="_images/peek.png" /></p>
</section>
<section id="real-robot">
<h2>Real Robot<a class="headerlink" href="#real-robot" title="Link to this heading">#</a></h2>
<p>Most of the technical details about how to operate the real robot can be found
in <a class="reference internal" href="using_the_real_robot.html"><span class="std std-doc">this</span></a> page and in the <a class="reference internal" href="lab6.html"><span class="std std-doc">lab 6 worksheet</span></a>.
These two pages will become available in Week 6.</p>
<p>But you can find a high-level step-by-step process below:</p>
<ol class="arabic simple">
<li><p>Connect to the robot via ssh and launch its drivers, as outlined <a class="reference internal" href="using_the_real_robot.html"><span class="std std-doc">here</span></a>.</p></li>
<li><p>Set up your PC to talk with the robot you are using, as outlined <a class="reference internal" href="using_the_real_robot.html"><span class="std std-doc">here</span></a>.</p></li>
<li><p>Run your <code class="docutils literal notranslate"><span class="pre">lab6</span></code> node <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">run</span> <span class="pre">lab6</span> <span class="pre">compressed_to_image_raw</span></code> (on the PC).</p></li>
<li><p>Generate a map of the real-world and save it under <code class="docutils literal notranslate"><span class="pre">worlds/real_world/map</span></code>
with the name <code class="docutils literal notranslate"><span class="pre">map</span></code>.</p></li>
<li><p>Launch localisation and navigation with the saved map you generated
previously.</p></li>
<li><p>Use Rviz to obtain the 4 points (entrance of room 1, entrance of room 2,
centre of room 1 and centre of room 2) and update the file
<code class="docutils literal notranslate"><span class="pre">worlds/real_world/coordinates.yaml</span></code>.</p></li>
<li><p>Provide an initial pose estimate for the robot in Rviz and also send few
goal positions to better localise the robot.</p></li>
<li><p>Send the robot to a starting position (corridor).</p></li>
<li><p>Run your solution using the provided launch file (i.e. <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">launch</span> <span class="pre">group_project</span> <span class="pre">robonaut_go.launch.py</span> <span class="pre">world:=real</span></code>).</p></li>
</ol>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#important-update-your-package">(IMPORTANT) Update your package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clone-your-group-repo">Clone your group repo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-the-project-in-simulation">How to run the project in simulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-points">Input points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-new-worlds">Creating new worlds</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#planet-images-and-alignment">Planet Images and Alignment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-images">Saving images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use-python-and-supporting-files-in-your-project">How to use Python and supporting files in your project</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recording-video-in-simulation">Recording video in simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#real-robot">Real Robot</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Rafael Papallas, Andy Bulpitt and Duygu Sarikaya
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Rafael Papallas, Andy Bulpitt and Duygu Sarikaya.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>